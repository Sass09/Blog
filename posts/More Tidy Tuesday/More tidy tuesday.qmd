
```{r message=FALSE}

library(tidyverse)
library(dplyr)
library(ggplot2)

suppressPackageStartupMessages({
  library(tidyverse)
  library(dplyr)
  library(ggplot2)
})

tuesdata <- tidytuesdayR::tt_load('2023-11-07')

house <-tuesdata$house



```

```{r}


cleandata<-house %>%
 filter(stage == "GEN" & year== "2022") %>%
  select(state, stage, party, candidatevotes) %>%
  filter(party  %in% c("DEMOCRAT", "REPUBLICAN"))  %>%
  na.omit()
  


#total votes for each party in each state 
  
totalvotes <- cleandata %>%
  group_by(state, party) %>%
  summarise(total = sum(candidatevotes)) %>%
  slice(which.max(total))
 
# mostvotes <- totalvotes %>%
    #group_by(state) %>%
    #top_n(1,total) 



totalvotes <- totalvotes[!(totalvotes$state == "ALASKA" | totalvotes$state== "HAWAII"),]    

usmapp <- map_data("state")

#it has to match state in map_data function

totalvotes$state <- tolower(totalvotes$state)


electiondf <- left_join(totalvotes, usmapp, by = c("state" = "region"))


ggplot(data = electiondf, aes(x= long, y= lat, group = group, fill= party))+
  geom_polygon(color= "black", size = 0.1) +
    scale_fill_manual(values = c("DEMOCRAT" = "blue", "REPUBLICAN" = "red")) + # Set colors for parties
  labs(title = "Party with Most Votes in Each State") +
  theme_void()






```

```{r}

#which party dominated California over the years in house general elections?

#a dataframe with column for years and party

cleandataforcali <- house %>%
  select(state, year, party, stage,candidatevotes) %>%
  na.omit() %>%
  filter(stage== "GEN" & state == "CALIFORNIA") 

#get sum of vvotes for each party  
sumofcalivotes<- cleandataforcali %>%
    group_by(year,state,party) %>%
  summarise(total = sum(candidatevotes)) %>%
   filter(party  %in% c("DEMOCRAT", "REPUBLICAN")) 
  
#maxvotes 
maxvotescal <- sumofcalivotes %>%
  group_by(party) %>%
  summarise(maxvotes= sum(total))

dominantparty<- maxvotescal$party[which.max(maxvotescal$maxvotes)]

print(paste("The dominating party is:", dominantparty))



```























