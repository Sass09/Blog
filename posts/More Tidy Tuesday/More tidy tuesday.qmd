```{r}

library(tidyverse)
library(dplyr)
library(ggplot2)

tuesdata <- tidytuesdayR::tt_load('2023-11-07')

house <-tuesdata$house


```

```{r}

cleandata<-house %>%
  filter(stage == "GEN" & year== "2022") %>%
  select(state_po, stage, party, totalvotes) %>%
  drop_na(party) %>%
  filter( party  %in% c("DEMOCRAT", "REPUBLICAN")) %>%
  rename(state = state_po)

#who won tht most votes in each state? 
  
mostvotes <- cleandata %>%
  group_by(state, party) %>%
  summarise( total = sum(totalvotes))
  
plott <- ggplot(data = mostvotes, mapping = aes(x =state, y= total, fill= party))+
  geom_bar(stat = "identity", position = "dodge")+
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust =1))

plott + theme(plot.margin = unit(c(0,-2,0,-2), "cm"))

#states are overcrowdwed 
#need ro adjust the x discrete scale












         


```
